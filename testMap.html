<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title></title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?libraries=drawing,places"></script>
  <script type="text/javascript" src="https://maps.google.com/maps/api/js?key=AIzaSyAqZmBR0L326jweeAj84JiwM54stfvbOIE&signed_in=true&libraries=places"></script>
  <script type="text/javascript" src="js/map.js"></script>
  <script type="text/javascript" src="js/position.js"></script>
  <script type="text/javascript" src="js/direction.js"></script>
  <script type="text/javascript" src="js/road.js"></script>
  <script type="text/javascript" src="js/testmap.js"></script>

  <link rel="stylesheet" herf="text/css" href="testMapCss.css">
  <script>
  var posArr = [];
  var isFindCurPos =false;
  function initialize() {
    initMap();
    initDirection();
    intiRoad();

  	getCurrentPosition();

  	var timer = setInterval(function(){
  		//getCurrentPosition();
  		getPositionId(g_currentPos);
      g_marker.setVisible(true);
      g_marker.setPosition(g_currentPos);
      if(!isFindCurPos && g_currentPos!=null){
        showInfo(g_currentPos,'Current Location');
        isFindCurPos=true;
      }
      var latlng = {lat:g_currentPos.lat, lng:g_currentPos.lng};
      posArr.push(latlng);
  	}, 500);
    var timer = setInterval(function(){
      //runSnapToRoad(posArr);
      posArr = [];
      if(isRouting){
        calcRoute();
        g_map.setCenter(g_currentPos);
        showDirection();
      }
    }, 1000);
  	setTimeout(function() {g_map.setCenter(g_currentPos);}, 200);
  }

  var isRouting = false;
  function rotue(){
    isRouting=!isRouting;
  }


  /* function resizeImage()
    {
      var window_height = document.body.clientHeight;

      var window_width = document.body.clientWidth;
      var image_width = document.images[0].width;
      var image_height = document.images[0].height;
      var height_ratio = image_height / window_height;
      var width_ratio = image_width / window_width;
      if (height_ratio > width_ratio)
      {
      document.images[0].style.width = "auto";
      document.images[0].style.height = "100%";
      }
      else
      {
      document.images[0].style.width = "100%";
      document.images[0].style.height = "auto";
      }
    }
*/
  </script>
</head>

<body onload="initialize()">
  <input type ="button" onclick="history.back()"  value="回到上一頁"></input>
	<input type="text" id="end"  placeholder="Destination location"/><br />
  <input type="button" value="導航" onclick="rotue()" id="direction"/>
	<table width="100%">
		<tr>
			<td style="vertical-align:top;"><div id="map" ></div></td>
			<p id="instructions"></p>
			<p id="distance"></p>
			<p id="txt_direction"></p>
			<table width="100%">
			<tr>
			<td height="50px"><h1 id ="left" ></h1></td>
			<td height="50px"><h1 id ="right"></h1></td>
			</tr>
			</table>
			
		</tr>
	</table>
    <div id="speedDiv" style="margin:1px 600px 0px 600px; width:500px"><font size="5">Speed:<input id="speed" type="number" min="1" max="500" step="1" value="20"/></font></div>
    <script src="https://www.google-analytics.com/urchin.js" type="text/javascript">
    </script>

 </body>

  <link href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">
</html>
